<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>EzBookz | All Appointments</title>
    <link href='fullcalendar/core/main.css' rel='stylesheet' />
    <link href='fullcalendar/daygrid/main.css' rel='stylesheet' />
    <script src='fullcalendar/core/main.js'></script>
    <script src='fullcalendar/daygrid/main.js'></script>
    <style>
      body {
        padding: 1rem;
      }

      h1 {
        font-size: 30px;
        text-align: center;
      }

      .btn-container {
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: center;
      }

      .btn {
        cursor: pointer;
        display: inline-block;
        padding: 10px;
        background-color: #87cefa;
        border-radius: 10px;
        transition: 0.2s;
      }

      .btn:hover {
        background-color: #66b3e3;
      }

      .btn-link {
        text-decoration: none;
        color: black;
      }
    </style>
</head>
<body>
    {% if session %}
    <h1>All Appointments</h1>
    <div class="btn-container">
      <p class="btn"><a class="btn-link" href="/">Home</a></p>
      <p class="btn"><a class="btn-link" href="/logout">Logout</a></p>
    </div>
    <div id='calendar'></div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
          plugins: ['dayGrid'],
          events: [
            {% for appointment in appointments %}
              {
                title: "{{ appointment.title }}",
                start: "{{ appointment.start_time }}",
                end: "{{ appointment.end_time }}",
                backgroundColor: "{{ 'green' if appointment.type == 'available' else 'red' }}",
              },
            {% endfor %}
          ]
        });
        calendar.render();
      });
    </script>
    {% else %}
    <h1>Welcome, Please Login to view appointments.</h1>
    <div class="btn-container">
      <p class="btn"><a class="btn-link" href="/login">Login</a></p>
    </div>
    {% endif %}
</body>
</html>